from itertools import groupby
import numpy as np
from matplotlib import pyplot as plt

raw_data1 = [
    ( 18, 0.14, 0.15 ),
    ( 18, 0.45, 0.64 ),
    ( 18, 0.46, 0.67 ),
    ( 18, 0.23, 0.37 ),
    ( 18, 0.20, 0.27 ),
    ( 18, 0.42, 0.52 ),
    ( 18, 0.26, 0.36 ),
    ( 18, 0.17, 0.20 ),
    ( 18, 0.19, 0.30 ),
    ( 18, 0.20, 0.34 ),
    ( 18, 0.16, 0.20 ),
    ( 18, 0.19, 0.30 ),
    ( 24, 0.15, 0.17 ),
    ( 24, 0.49, 0.53 ),
    ( 24, 0.54, 0.71 ),
    ( 24, 0.24, 0.44 ),
    ( 24, 0.22, 0.34 ),
    ( 24, 0.43, 0.57 ),
    ( 24, 0.26, 0.30 ),
    ( 24, 0.14, 0.25 ),
    ( 24, 0.16, 0.19 ),
    ( 24, 0.30, 0.78 ),
    ( 24, 0.18, 0.34 ),
    ( 24, 0.18, 0.25 ),
    ( 40, 0.13, 0.14 ),
    ( 40, 0.54, 0.70 ),
    ( 40, 0.31, 0.42 ),
    ( 40, 0.22, 0.47 ),
    ( 40, 0.70, 0.75 ),
    ( 40, 0.34, 0.41 ),
    ( 40, 0.77, 0.78 ),
    ( 40, 0.25, 0.61 ),
    ( 40, 0.22, 0.40 ),
    ( 40, 0.13, 0.13 ),
    ( 40, 0.17, 0.26 ),
    ( 40, 0.20, 0.35 ),
    ( 31, 0.09, 0.10 ),
    ( 31, 0.20, 0.21 ),
    ( 31, 0.35, 0.47 ),
    ( 31, 0.27, 0.51 ),
    ( 31, 0.29, 0.68 ),
    ( 31, 0.24, 0.27 ),
    ( 31, 0.65, 0.68 ),
    ( 31, 0.09, 0.13 ),
    ( 31, 0.15, 0.16 ),
    ( 31, 0.12, 0.14 ),
    ( 31, 0.22, 0.37 ),
    ( 31, 0.20, 0.40 ),
    ( 44, 0.12, 0.14 ),
    ( 44, 0.55, 0.63 ),
    ( 44, 0.26, 0.40 ),
    ( 44, 0.30, 0.68 ),
    ( 44, 0.24, 0.39 ),
    ( 44, 0.25, 0.30 ),
    ( 44, 0.19, 0.32 ),
    ( 44, 0.18, 0.31 ),
    ( 44, 0.21, 0.23 ),
    ( 44, 0.16, 0.23 ),
    ( 44, 0.34, 0.81 ),
    ( 44, 0.39, 0.58 ),
    ( 55, 0.11, 0.11 ),
    ( 55, 0.28, 0.32 ),
    ( 55, 0.24, 0.39 ),
    ( 55, 0.56, 0.60 ),
    ( 55, 0.46, 0.56 ),
    ( 55, 0.61, 0.57 ),
    ( 55, 0.52, 0.56 ),
    ( 55, 0.17, 0.29 ),
    ( 55, 0.15, 0.30 ),
    ( 55, 0.23, 0.27 ),
    ( 55, 0.23, 0.28 ),
    ( 55, 0.29, 0.47 ),
    ( 20, 0.14, 0.15 ),
    ( 20, 0.35, 0.46 ),
    ( 20, 0.47, 0.59 ),
    ( 20, 0.22, 0.42 ),
    ( 20, 0.18, 0.35 ),
    ( 20, 0.38, 0.41 ),
    ( 20, 0.72, 0.64 ),
    ( 20, 0.13, 0.17 ),
    ( 20, 0.17, 0.23 ),
    ( 20, 0.22, 0.31 ),
    ( 20, 0.17, 0.28 ),
    ( 20, 0.16, 0.23 ),
    ( 50, 0.06, 0.07 ),
    ( 50, 0.35, 0.40 ),
    ( 50, 0.31, 0.45 ),
    ( 50, 0.74, 0.85 ),
    ( 50, 0.48, 0.58 ),
    ( 50, 0.72, 0.80 ),
    ( 50, 0.20, 0.28 ),
    ( 50, 0.22, 0.32 ),
    ( 50, 0.25, 0.36 ),
    ( 50, 0.16, 0.30 ),
    ( 50, 0.46, 0.50 ),
    ( 50, 0.17, 0.21 ),
    ( 60, 0.84, 0.74 ),
    ( 60, 0.33, 0.38 ),
    ( 60, 0.55, 0.62 ),
    ( 60, 0.55, 0.74 ),
    ( 60, 0.77, 0.94 ),
    ( 60, 0.77, 0.80 ),
    ( 60, 0.55, 0.62 ),
    ( 60, 0.53, 0.54 ),
    ( 60, 0.30, 0.58 ),
    ( 60, 0.28, 0.33 ),
    ( 60, 0.28, 0.29 ),
    ( 60, 0.32, 0.45 ),
    ( 60, 0.30, 0.33 ),
    ( 28, 0.10, 0.10 ),
    ( 28, 0.25, 0.26 ),
    ( 28, 0.43, 0.53 ),
    ( 28, 0.28, 0.42 ),
    ( 28, 0.19, 0.31 ),
    ( 28, 0.31, 0.38 ),
    ( 28, 0.24, 0.29 ),
    ( 28, 0.20, 0.30 ),
    ( 28, 0.13, 0.16 ),
    ( 28, 0.23, 0.34 ),
    ( 28, 0.19, 0.27 ),
    ( 28, 0.21, 0.31 ),
    ( 65, 0.69, 0.70 ),
    ( 65, 0.26, 0.35 ),
    ( 65, 0.37, 0.50 ),
    ( 65, 0.77, 0.96 ),
    ( 65, 0.74, 1.12 ),
    ( 65, 0.54, 0.71 ),
    ( 65, 0.65, 0.76 ),
    ( 65, 0.36, 0.42 ),
    ( 65, 0.43, 0.51 ),
    ( 65, 0.33, 0.35 ),
    ( 65, 0.29, 0.37 ),
    ( 65, 0.37, 0.60 ),
    ( 35, 0.10, 0.11 ),
    ( 35, 0.24, 0.45 ),
    ( 35, 0.25, 0.43 ),
    ( 35, 0.28, 0.42 ),
    ( 35, 0.55, 0.68 ),
    ( 35, 0.23, 0.25 ),
    ( 35, 0.29, 0.38 ),
    ( 35, 0.15, 0.30 ),
    ( 35, 0.14, 0.24 ),
    ( 35, 0.20, 0.25 ),
    ( 35, 0.36, 0.59 ),
    ( 35, 0.49, 0.89 ),
    ( 70, 0.52, 0.56 ),
    ( 70, 0.45, 0.57 ),
    ( 70, 0.44, 0.57 ),
    ( 70, 0.77, 0.95 ),
    ( 70, 0.82, 0.96 ),
    ( 70, 0.65, 0.77 ),
    ( 70, 0.50, 0.80 ),
    ( 70, 0.38, 0.57 ),
    ( 70, 0.35, 0.39 ),
    ( 70, 0.35, 0.48 ),
    ( 70, 0.35, 0.46 ),
    ( 70, 0.43, 0.64 ),
]

firstitem = lambda v: v[0]
raw_data1.sort(key=firstitem)
data1 = []
for zoom, group in groupby(raw_data1, firstitem):
    group = np.array(list(group))
    data1.append([ zoom, np.sqrt(np.mean(group[:,1]**2)), np.sqrt(np.max(group[:,2]**2)) ])

plt.figure(figsize=(6*1.2,7*1.2))

plt.subplot(2,1,1)
data1 = np.array(data1)
max_bars  = plt.bar(np.arange(len(data1))+0.1, data1[:,2], color='#a0a5a5', edgecolor='#505353', width=0.4)
mean_bars = plt.bar(np.arange(len(data1))-0.2, data1[:,1], color='#396AB1', edgecolor='#1D3555', width=0.4)
plt.legend( (max_bars[0], mean_bars[0]), ('max', 'mean'), loc='upper left' )
plt.gca().set_xticks(range(len(data1)))
plt.gca().set_xticklabels([ int(d) for d in data1[:,0] ])
plt.xlim([-1, len(data1)+1])
plt.xlabel('(a) calibrated zoom levels')
plt.ylabel('residual (pixels)')

data2 = np.array([
    [ 22, 0.47, 0.69 ],
    [ 29, 0.40, 0.67 ],
    [ 38, 0.15, 0.26 ],
    [ 42, 0.14, 0.16 ],
    [ 46, 0.16, 0.31 ],
    [ 52, 0.43, 0.53 ],
    [ 62, 0.86, 0.94 ],
])

plt.subplot(2,1,2)
max_bars  = plt.bar(np.arange(len(data2))+0.0625, data2[:,2], color='#a0a5a5', edgecolor='#505353', width=0.25)
mean_bars = plt.bar(np.arange(len(data2))-0.125, data2[:,1], color='#396AB1', edgecolor='#1D3555', width=0.25)
plt.gca().set_xticks(range(len(data2)))
plt.gca().set_xticklabels([ int(d) for d in data2[:,0] ])
plt.xlim([-1, len(data2)+1])
plt.xlabel('(b) interpolated zoom levels')
plt.ylabel('residual (pixels)')

plt.tight_layout()
plt.show()